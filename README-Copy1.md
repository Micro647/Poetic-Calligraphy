古文诗词领域助手诗墨




![image](https://github.com/wdj157/PoeticCalligraphy/blob/main/%E7%A4%BA%E6%84%8F.png)


用法：


本模型是基于INTERNLM-7b-chat在古文诗词领域数据集以及诗墨自我认知数据集上微调的结果，采用gradio页面部署，并且添加与模型在线对战功能，考验你与模型在古文诗词领域能力的对比！还有还会基于Agentlego生成诗词配图功能以及茴香豆对于外部古文诗词文档检索问答功能。


初步示意图：


![image](https://github.com/wdj157/PoeticCalligraphy/blob/main/%E6%95%B4%E4%BD%93%E9%80%BB%E8%BE%91.jpg)

未来将会增添更多功能！！

![image](https://github.com/wdj157/PoeticCalligraphy/blob/main/%E6%95%B4%E4%BD%93%E9%80%BB%E8%BE%91.jpg)


对战功能已经初步产生，但由于不稳定，因此，只将原来的demo予以展示，后续测试成功将会继续使用：


一，可用于古文诗词领域知识问答：


其中，古文诗词微调语料分为三部分，如下所示：

1，hugggingface
   从huggingface上下载有关诗词微调数据集，并将其清洗成为指令微调形式。多方来源很重要，可以保证模型回答的多样性。


2，github
   从github上下载古诗词数据集，其大多都是对于诗人的诗词的介绍，清洗为指令微调格式，能够有效解决对于相关诗词不理解，知识盲区问题。

3，GLM-4
   采用相关提示词模板，不断迭代，从GLM-4以及其有关古诗词领域智能体中迭代出对应的指令微调数据集，其主要分为几个方面：
   相关典故，诗人生平介绍，文学创造，生平趣事，古文背诵等几方面分别创造相关数据集。

随后，采用xtuner基于INTERNLM-7b-chat进行微调，经过xtuner chat以及lmdeploy验证，其能够在相关古文诗词领域数据集上展现较好效果

二，诗墨对于自己有清晰的认知

为实现这个功能，尝试了不同的技术路线

1，直接采用课程方式
    对于方式一，本方法直接采用教程方法，直接在单类数据上进行过拟合尝试，但最后模型被训“傻”了，只会在单句上回答。
    
2，将其均匀打乱到上一步骤的指令微调数据集
    对于此方法，将方式一中的数据均匀插入古文诗词微调语料中，重新训练模型，效果依旧较差。

3，模仿有关工作将自我认知数据集变得复杂多样
    对于此方法，将自我认知数据集用各种不同方法表示，而不是一种，使得微调数据多种多样，不至于发生过拟合行为。

4，模仿相关工作复杂化自我认知数据集并将其均匀混至新生成的古文诗词领域微调数据集，让其有清晰认知。

经过方法三的尝试，即不断的迭代过程，模型可对自己名字，自己英文名称以及开发自己的团队有了清晰地认知。


三，与模型在线对战

为实现此功能，主要在两部分工作的进行

1，在线对战题库生成
   分别从古诗词领域相关文本，古诗词领域指令微调数据以及DeepSeekv2的api调用，并采用相关提示词将三者共同组合而成

2，对战页面
   对战页面已经生成，能够在题库中的选择题中自行选择，并完成在线对战功能，但两个与gradio页面显示的组件绑定的函数需要同时加载微调后的模型。openxlab显存还有待进一步解决。


未来将实现功能：

一，RAG功能
 
 通过基于茴香豆的知识库，完成将有关文档上传，完成对于基于对于文档的交互。

二，Agentlego功能
  
  完成诗词生图功能，对于给定的诗词，能够直接生成对应意境的图，增加互动的趣味性与娱乐性。



附录：

采用lmdeploy部署方法：

cd /chat_with_model/lmdeploy-main

首先安装lmdeploy

conda create -n lmdeploy python==3.10.6

pip install -r requirements.txt


与古文诗词领域助手诗墨直接对话

conda activate lmdeploy

lmdeploy chat /model





 
